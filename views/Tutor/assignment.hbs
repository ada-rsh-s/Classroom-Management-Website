<!-- Mirrored from www.multipurposethemes.com/admin/eduadmin-template/front-end/mydashboard.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 23 Nov 2020 08:29:37 GMT -->

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="">
	<meta name="author" content="">
	<link rel="icon" href="https://www.multipurposethemes.com/admin/eduadmin-template/images/favicon.ico">

	<title>EduAdmin - Dashboard</title>
	<link href="../Studtable/style.bundled1cf.css" rel="stylesheet" type="text/css" />

	<!-- Vendors Style-->
	<link rel="stylesheet" href="../Template/css/vendors_css.css">

	<!-- Style-->
	<link rel="stylesheet" href="../Template/css/style.css">

</head>

<body class="theme-primary">

	<section style="margin-top: -450px;" class="py-50">
		<div class="container">
			<center>
				<h1 style="font-family: 'Times New Roman', Times, serif;">ASSIGNMENTS</h1>
			</center>

			<div class="row">


				<div class="col-lg-12 col-md-8 mt-3 col-12">
					<div class="box">
						<div class="box-body">
							<div class="tab-content" id="pills-tabContent23">
								<div class="tab-pane fade show active" id="pills-edit" role="tabpanel"
									aria-labelledby="pills-edit-tab">
									<div class="row">
										<div class="col-12">
											<form id="form" class="form" method="POST" action="/tutor/assignments"
												enctype="multipart/form-data">
												<div>
													<h4 class="box-title text-primary"><i
															class="ti-user mr-15"></i>ASSIGNMENTS</h4>
													<hr class="my-15">
													<div class="row">
														<div class="col-md-12">

															<div class="form-group">
																<label>Topic</label>
																<input type="text" class="form-control" id="topic"
																	name="Topic" onchange="buttonValidation()" required
																	placeholder="Topic">
															</div>
														</div>

													</div>
													<div class="row">
														<div class="col-md-12">
															<div class="form-group">
																<label>File</label>
																<input type="file" class="form-control" id="file1"
																	required name="file"
																	onchange="return fileValidation()">
															</div>
														</div>

													</div>

													<input type="text" name="Date" value="{{date}}" hidden id="">


													<button id="button" style="display: none;"
														onclick="uploadFile();showDiv();" type="submit"
														class="btn btn-success">
														Upload <img style="margin-bottom: 2px;"
															src="../Template/icons/themify-icons/SVG/upload.svg" alt=""
															srcset="">
													</button>
												</div>
											</form>
											<div id="progress" style="display: none; height:18px; width: 310px;"
												class="progress progress-bar-striped active">
												<progress id="progressBar" value="0" max="100"
													style="margin-top: -7.5px;  width: 310px;  height: 30px;"></progress>
											</div>
											<h4 class="box-title text-primary" id="status"></h4>
											<p style="font-family:monospace;" id="loaded_n_total"></p>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</section>
	<div style="margin-top: -50px;" class="d-flex flex-column flex-root">

		<div class="d-flex flex-row flex-column-fluid page">

			<div class="d-flex flex-column flex-row-fluid" id="kt_wrapper">

				<div class="content d-flex flex-column flex-column-fluid" id="kt_content">

					<div class="d-flex flex-column-fluid">
						<!--begin::Container-->

						<div class="container">



							<div class="card card-custom">
								<div class="card-body">
									<!--begin: Datatable-->
									<table class=" table-bordered table-hover table-checkable "
										style="width: 100%; table-layout: fixed;">
										<thead style="line-height: 50px;">

											<tr>
												<th>
													<center>Date</center>
												</th>
												<th>
													<center>Topic</center>
												</th>
												<th>
													<center>File</center>
												</th>
												<th>
													<center>Delete</center>
												</th>
											</tr>
										</thead>
										<tbody>
											{{#each assign}}
											<tr>
												<td>
													<center>{{this.Topic.Date}}</center>
												</td>
												<td>
													<center>{{this.Topic.Topic}}</center>
												</td>
												<td>
													<center><a href="../Assignments/{{this._id}}.pdf ">
															<center><img style="height: 40px; width: auto;"
																	src="../Notes/open-document.png" alt="W3Schools"
																	width="104" height="142"><br><small
																	style="color: rgb(17, 165, 17);">Click to view the
																	file</small></center>
													</center>
												</td>
												<td>
													<center> <a style="cursor: pointer;"
															onclick="delconfirm('{{this._id}}')"><img
																src="../Studtable/trash-9-24.ico" alt="" srcset=""></a>
													</center>
												</td>
												<td hidden nowrap="nowrap"></td>
											</tr>
											{{/each}}
										</tbody>
									</table>
								</div>
							</div>
						</div>
					</div>
				</div>

			</div>
		</div>
	</div>

	<script>
		function fileValidation() {
			var fileInput =
				document.getElementById('file1');

			var filePath = fileInput.value;
			var allowedExtensions =
				/(\.pdf)$/i;

			if (!allowedExtensions.exec(filePath)) {
				swal("Error!", "Upload PDF only", "error");
				fileInput.value = '';
				return false;
			} else {
				if (document.getElementById('topic').value == "") {
					console.log("hy")
				} else {
					document.getElementById('button').style.display = "block";
					document.getElementById('button').style.float = "right";
				}
			}
		}

		function buttonValidation() {
			var fileInput =
				document.getElementById('file1');

			var filePath = fileInput.value;
			var allowedExtensions =
				/(\.pdf)$/i;

			if (!allowedExtensions.exec(filePath)) {
				fileInput.value = '';
				return false;
			} else {
				if (document.getElementById('topic').value == "") {
					console.log("hy")
				} else {
					document.getElementById('button').style.display = "block";
					document.getElementById('button').style.float = "right";
				}
			}
		}

		function showDiv() {
			document.getElementById('progress').style.display = "block";
		}
		function _(el) {
			return document.getElementById(el);
		}

		function uploadFile() {

			var file = _("file1").files[0];
			// alert(file.name+" | "+file.size+" | "+file.type);
			var formdata = new FormData();
			formdata.append("file1", file);
			var ajax = new XMLHttpRequest();
			ajax.upload.addEventListener("progress", progressHandler, false);
			ajax.addEventListener("load", completeHandler, false);
			ajax.addEventListener("error", errorHandler, false);
			ajax.addEventListener("abort", abortHandler, false);
			ajax.open("POST", "/tutor/test"); // http://www.developphp.com/video/JavaScript/File-Upload-Progress-Bar-Meter-Tutorial-Ajax-PHP
			//use file_upload_parser.php from above url
			ajax.send(formdata);
		}

		function progressHandler(event) {
			_("loaded_n_total").innerHTML = "Uploaded " + event.loaded + " bytes of " + event.total;
			var percent = (event.loaded / event.total) * 100;
			_("progressBar").value = Math.round(percent);
			_("status").innerHTML = Math.round(percent) + "% uploaded... <br>Please wait.. , Dont do any other operations";
		}

		function completeHandler(event) {
			_("status").innerHTML = event.target.responseText;
			_("progressBar").value = 0; //wil clear progress bar after successful upload
		}

		function errorHandler(event) {
			_("status").innerHTML = "Upload Failed";
		}

		function abortHandler(event) {
			_("status").innerHTML = "Upload Aborted";
		}
	</script>
	<!-- Vendor JS -->
	<script src="../Template/js/vendors.min.js"></script>
	<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
	<script src="../Template/corenav-master/coreNavigation-1.1.3.js"></script>
	<script src="../Template/vendor_components/jquery-ui/jquery-ui.min.js"></script>
	<script src="../socket.io/socket.io.js"></script>
	<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
	<script>
		var socket = io();
		document.getElementById("form").onsubmit = function () {
			var topic = document.getElementById("topic").value;
			let type = "Assignment"
			socket.emit("message", topic, type)
		}

		function delconfirm(studid) {
			swal({
				title: "Are you sure?",
				text: "Once deleted, you will not be able to recover this Assignment!",
				icon: "warning",
				buttons: true,
				dangerMode: true,
			})
				.then((willDelete) => {
					if (willDelete) {
						window.location = "/tutor/delete-assign/" + studid
					} else {
						swal("Your Assignment is safe!");
					}
				});
		}
	</script>

</body>